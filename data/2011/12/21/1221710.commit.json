{
  "when": "2011-12-21T08:17:35-05:00", 
  "message": "Configuration language guide update", 
  "who": "hiranya", 
  "changes": [
    {
      "chunks": [
        {
          "locn": "-326,6 +326,18", 
          "lines": [
            "                     not be based on REST.\n", 
            "                 </p>\n", 
            "             </subsection>\n", 
            "+            <subsection name=\"Priority Executors\">\n", 
            "+                <p>\n", 
            "+                    Priority executors can be used to execute sequences with a given priority.\n", 
            "+                    Priority executors are used in high load scenarios where user wants to execute\n", 
            "+                    different sequences at different priority levels. This allows user to control\n", 
            "+                    the resources allocated to executing sequences and prevent high priority messages\n", 
            "+                    from getting delayed and dropped. A priority has a specific meaning compared to\n", 
            "+                    other priorities specified. For example if we have two priorities with value 10\n", 
            "+                    and 1, messages with priority 10 will get 10 times more resources than messages\n", 
            "+                    with priority 1.\n", 
            "+                </p>\n", 
            "+            </subsection>\n", 
            "         </section>\n", 
            "         <section name=\"Synapse Configuration Files\">\n", 
            "             <p>\n"
          ]
        }, 
        {
          "locn": "-339,6 +351,8", 
          "lines": [
            "                 <li>endpoints</li>\n", 
            "                 <li>events</li>\n", 
            "                 <li>local-entries</li>\n", 
            "+                <li>message-processors</li>\n", 
            "+                <li>message-stores</li>\n", 
            "                 <li>priority-executors</li>\n", 
            "                 <li>proxy-services</li>\n", 
            "                 <li>sequences</li>\n"
          ]
        }, 
        {
          "locn": "-368,6 +382,8", 
          "lines": [
            "     |   `-- event1.xml\n", 
            "     |-- local-entries\n", 
            "     |   `-- bar.xml\n", 
            "+    |-- message-processors\n", 
            "+    |-- message-stores\n", 
            "     |-- priority-executors\n", 
            "     |-- proxy-services\n", 
            "     |   |-- proxy1.xml\n"
          ]
        }, 
        {
          "locn": "-1118,5 +1134,176", 
          "lines": [
            "                 </tbody>\n", 
            "             </table>\n", 
            "         </section>\n", 
            "+        <section name=\"Scheduled Tasks\">\n", 
            "+            <p>\n", 
            "+                A &lt;task&gt; element is used to define a Synapse task (aka startup).\n", 
            "+            </p>\n", 
            "+            <div class=\"xmlConf\">&lt;task class=\"mypackage.MyTask\" name=\"string\" [pinnedServers=\"(serverName)+\"]&gt;\n", 
            "+   &lt;property name=\"stringProp\" value=\"String\"/&gt;\n", 
            "+   &lt;property name=\"xmlProp\"&gt;\n", 
            "+     &lt;somexml&gt;config&lt;/somexml&gt;\n", 
            "+   &lt;/property&gt;\n", 
            "+   &lt;trigger ([[count=\"10\"]? interval=\"1000\"] | [cron=\"0 * 1 * * ?\"] | [once=(true | false)])/&gt;\n", 
            "+&lt;/task&gt;</div>\n", 
            "+            <p>\n", 
            "+                A task is created and scheduled to run at specified time intervals or as specified\n", 
            "+                by the cron expression. The 'class' attribute specifies the actual task\n", 
            "+                implementation class (which must implement org.apache.synapse.task.Task interface)\n", 
            "+                to be executed at the specified interval/s, and name specifies an identifier for\n", 
            "+                the scheduled task.\n", 
            "+            </p>\n", 
            "+            <p>\n", 
            "+                Fields in the task class can be set using properties provided as string literals or\n", 
            "+                XML fragments. For example, if the task implementation class has a field named\n", 
            "+                'version' with a corresponding setter method, the configuration value which will be\n", 
            "+                assigned to this field before running the task can be specified using a property with\n", 
            "+                the name 'version'.\n", 
            "+            </p>\n", 
            "+            <p>\n", 
            "+                There are three different trigger mechanisms to schedule tasks. A simple trigger is\n", 
            "+                specified with a 'count' and an 'interval', implying that the task will run a\n", 
            "+                'count' number of times at specified intervals. A trigger may also be specified as\n", 
            "+                a cron trigger using a cron expression. A one-time trigger is specified using the\n", 
            "+                'once' attribute in the definition and could be specified as true in which case the\n", 
            "+                task will be executed only once just after the initialization of Synapse.\n", 
            "+            </p>\n", 
            "+            <p>\n", 
            "+                In clustered deployments sometimes it would be necessary to deploy a particular task\n", 
            "+                in a selected set of nodes. This can be achieved using the optional 'pinnedServers'\n", 
            "+                attribute. A list of server names or host names can be specified in this attribute.\n", 
            "+                At server startup, Synapse will match the current server name or the host name with\n", 
            "+                the values specified in this attribute to see whether the task should be initialized\n", 
            "+                or not.\n", 
            "+            </p>\n", 
            "+        </section>\n", 
            "+        <section name=\"Event Sources\">\n", 
            "+            <p>\n", 
            "+                Event sources enable the user to run Synapse in the eventing mode of operation.\n", 
            "+                Synapse can act as an event source as well as an event broker. An event source\n", 
            "+                is defined using the &lt;eventSource&gt; configuration element.\n", 
            "+            </p>\n", 
            "+            <div class=\"xmlConf\">&lt;eventSource name=\"string\"&gt;\n", 
            "+\t&lt;subscriptionManager class=\"mypackage.MyClass\"&gt;\n", 
            "+\t\t   &lt;parameter name=\"string\"/&gt;\n", 
            "+\t&lt;/subscriptionManager&gt;\n", 
            "+&lt;/eventSource&gt;</div>\n", 
            "+            <p>\n", 
            "+                Once an event source is deployed in Synapse, it will provide a service URL (EPR) to\n", 
            "+                which clients can send WS-Eventing subscription requests. Clients can subscribe,\n", 
            "+                unsubscribe and renew subscriptions by sending messages to this EPR. The subscription\n", 
            "+                manager configured inside the event source will be responsible for storing\n", 
            "+                and managing the subscriptions. The 'class' attribute of the 'subscriptionManager'\n", 
            "+                element should point to the Java class which provides this subscription management\n", 
            "+                functionality. Synapse ships with an in-memory subscription manager which\n", 
            "+                keeps and manages all subscriptions in memory.\n", 
            "+            </p>\n", 
            "+            <p>\n", 
            "+                Any additional parameters required to configure the subscription manager implementation\n", 
            "+                can be specified using the 'parameter' elements.\n", 
            "+            </p>\n", 
            "+        </section>\n", 
            "+        <section name=\"APIs\">\n", 
            "+            <p>\n", 
            "+                APIs provide a flexible and powerful approach for defining full fledged REST APIs\n", 
            "+                in Synapse. An API definition starts with the &lt;api&gt; element.\n", 
            "+            </p>\n", 
            "+            <div class=\"xmlConf\">&lt;api name=\"string\" context=\"string\" [hostname=\"string\"][port=\"int\"]&gt;\n", 
            "+   &lt;resource [methods=\"http-method-list\"][inSequence=\"string\"][outSequence=\"string\"]\n", 
            "+   \t\t[faultSequence=\"string\"][content-type=\"string\"][user-agent=\"str\"]&gt;\n", 
            "+      &lt;inSequence&gt;...&lt;/inSequence&gt;?\n", 
            "+      &lt;outSequence&gt;...&lt;/outSequence&gt;?\n", 
            "+      &lt;faultSequence&gt;...&lt;/faultSequence&gt;?\n", 
            "+   &lt;/resource&gt;+\n", 
            "+   &lt;handlers&gt;\n", 
            "+      &lt;handler class=\"name\"/&gt;+\n", 
            "+   &lt;/handlers&gt;?\n", 
            "+&lt;/api&gt;</div>\n", 
            "+            <p>\n", 
            "+                Each API definition must be uniquely named using the 'name' attribute. The 'context'\n", 
            "+                attribute is used to define the URL context at which the REST API will be anchored\n", 
            "+                (eg: /ws, /foo/bar, /soap). The API will only receive requests that fall in the\n", 
            "+                specified URL context. In addition to that an API could be bound to a particular\n", 
            "+                host and a port using the 'hostname' and 'port' attributes.\n", 
            "+            </p>\n", 
            "+            <p>\n", 
            "+                An API must also contain one or more resources. Resources define how messages\n", 
            "+                are processed and mediated by the API. An API can be associated with a set of HTTP\n", 
            "+                methods using the 'methods' attribute. This attribute can support a single method name\n", 
            "+                (eg: GET) or a space separated list of methods (eg: GET PUT DELETE). A resource\n", 
            "+                can also refer other sequences using the 'inSequence', 'outSequence' and 'faultSequence'\n", 
            "+                attributes. Alternatively these mediation sequences can be defined inline with the\n", 
            "+                resource using 'inSequence', 'outSequence' and 'faultSequence' tags.\n", 
            "+            </p>\n", 
            "+            <p>\n", 
            "+                An API can also optionally define a set of handlers. These handlers are invoked\n", 
            "+                for each incoming API request, before they are dispatched to the appropriate\n", 
            "+                resources. The 'class' attribute on the 'handler' elements should contain the\n", 
            "+                ful qualified names of the handler implementation classes.\n", 
            "+            </p>\n", 
            "+        </section>\n", 
            "+        <section name=\"Priority Executors\">\n", 
            "+            <p>\n", 
            "+                The priority executor configuration syntax takes the following general form.\n", 
            "+            </p>\n", 
            "+            <div class=\"xmlConf\">&lt;priority-executor name=&quot;string&quot;&gt;\n", 
            "+    &lt;queues isFixed=&quot;true|false&quot; nextQueue=&quot;class implementing NextQueueAlgorithm&quot;&gt;\n", 
            "+        &lt;queue [size=&quot;size of the queue&quot;] priority=&quot;priority of the messages put in to this queue&quot;/&gt;*\n", 
            "+    &lt;/queues&gt;\n", 
            "+    &lt;threads core=&quot;core number of threads&quot; max=&quot;max number of threads&#39; keep-alive=&quot;keep alive time&quot;/&gt;\n", 
            "+&lt;/priority-executor&gt;</div>\n", 
            "+            <p>\n", 
            "+                A priority executor consists of a thread pool and a set of queues for different\n", 
            "+                priority levels. Queues can be either bounded on unbounded in terms of capacity.\n", 
            "+                Each executor must define at least two queues. By default queues are unbounded.\n", 
            "+                By specifying the attribute 'size' they can be configured to have a limited capacity.\n", 
            "+                The 'priority' attribute specifies the priority level associated with a particular\n", 
            "+                queue. As explained earlier, higher the level, higher the priority the messages will\n", 
            "+                get.\n", 
            "+            </p>\n", 
            "+            <p>\n", 
            "+                The next queue algorithm is used to determine the next message processed. By default\n", 
            "+                Synapse uses a built-in priority queueing algorithm for this purpose. If required a\n", 
            "+                custom algorithm can be used by specifying the 'nextQueue' algorithm on the 'queues'\n", 
            "+                element.\n", 
            "+            </p>\n", 
            "+            <p>\n", 
            "+                The 'threads' element is used to configure the underlying thread pool. The 'core'\n", 
            "+                and 'max' attributes are used to specify the initial size and the maximum size of the\n", 
            "+                thread pool. A keep-alive time duration can be specified for idling threads using\n", 
            "+                the 'keep-alive' attribute where the duration is configured in seconds. If not\n", 
            "+                specified a default keep-alive duration of 5 seconds will be used.\n", 
            "+            </p>\n", 
            "+            <p>\n", 
            "+                In order to process messages through a priority executor one must use the 'enqueue'\n", 
            "+                mediator. This mediator can be used in a sequence or a proxy service to get all\n", 
            "+                requests processed through a pre-configured priority executor.\n", 
            "+            </p>\n", 
            "+            <div class=\"xmlConf\">&lt;enqueue priority=\"10\" executor=\"MyExecutor\"/&gt;</div>\n", 
            "+            <p>\n", 
            "+                For best results it's recommended to dispatch messages into priority executors\n", 
            "+                straight from the transport level. This can be achieved by adding an additional\n", 
            "+                parameter to the NHTTP transport configuration in the axis2.xml file of Synapse.\n", 
            "+            </p>\n", 
            "+            <div class=\"xmlConf\">&lt;parameter name=\"priorityConfigFile\"&gt;file path&lt;/parameter&gt;</div>\n", 
            "+            <p>\n", 
            "+                The parameter should point to a separate XML configuration which defines the\n", 
            "+                priority configuration.\n", 
            "+            </p>\n", 
            "+            <div class=\"xmlConf\">&lt;Priority-Configuration&gt;\n", 
            "+    &lt;priority-executor name=\"priority-executor\"&gt;\n", 
            "+        &lt;queues isFixed=\"true|false\"&gt;\n", 
            "+            &lt;queue [size=\"\"] priority=\"\"/&gt;*\n", 
            "+        &lt;/queues&gt;\n", 
            "+        &lt;threads core=\"core number of threads\" max=\"max number of threads' keep-alive=\"keep alive time\"/&gt;\n", 
            "+    &lt;/priority-executor&gt;\n", 
            "+\n", 
            "+    &lt;!-- conditions for calculating the priorities based on HTTP message --&gt;\n", 
            "+    &lt;conditions defaultPriority=\"default priority as an integer\"&gt;\n", 
            "+        &lt;condition priority=\"priority value as an integer\"&gt;\n", 
            "+            one evaluator, this evaluator can contain other evaluators\n", 
            "+        &lt;/condition&gt;\n", 
            "+    &lt;/conditions&gt;\n", 
            "+&lt;/Priority-Configuration&gt;</div>\n", 
            "+        </section>\n", 
            "     </body>\n", 
            " </document>\n", 
            "\\ No newline at end of file\n"
          ]
        }
      ], 
      "to": "scratch/hiranya/website/src/site/xdoc/userguide/config.xml", 
      "from": "scratch/hiranya/website/src/site/xdoc/userguide/config.xml"
    }
  ], 
  "id": "1221710"
}