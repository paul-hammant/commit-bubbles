{
  "when": "2013-08-18T18:59:22-04:00", 
  "message": "Updated documentation", 
  "who": "hiranya", 
  "changes": [
    {
      "chunks": [
        {
          "locn": "-33,7 +33,17", 
          "lines": [
            "                     <a href=\"#Configuration\">Transport Configuration</a>\n", 
            "                     <ul>\n", 
            "                         <li><a href=\"#Listener\">File Transport Listener (VFS Listener)</a></li>\n", 
            "-                        <li><a href=\"#Sender\">File Transport Sender (VFS Sender)</a></li>\n", 
            "+                        <li>\n", 
            "+                            <a href=\"#Sender\">File Transport Sender (VFS Sender)</a>\n", 
            "+                            <ul>\n", 
            "+                                <li><a href=\"#Locking\">File Locking</a></li>\n", 
            "+                                <li><a href=\"#Passive\">FTP Passive Mode</a></li>\n", 
            "+                                <li><a href=\"#Retry\">Retrying on Error</a></li>\n", 
            "+                                <li><a href=\"#transport.vfs.UseTempFile\">Using Temporary Files</a></li>\n", 
            "+                                <li><a href=\"#Append\">Appending to Files</a></li>\n", 
            "+                                <li><a href=\"#OutOnly\">Out-only Message Exchange Pattern</a></li>\n", 
            "+                            </ul>\n", 
            "+                        </li>\n", 
            "                     </ul>\n", 
            "                 </li>\n", 
            "                 <li>\n"
          ]
        }, 
        {
          "locn": "-137,7 +147,7", 
          "lines": [
            "                             a directory location is specified, the transport will attempt to read\n", 
            "                             any file dropped into the directory.\n", 
            "                             <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.FileURI\"&gt;file:///home/user/test/in&lt;/parameter&gt;</div>\n", 
            "-                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.FileURI\"&gt;sftp://bob:password@ftp.example.org/test/in&lt;/parameter&gt;</div>\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.FileURI\"&gt;sftp://bob:password@example.com/logs&lt;/parameter&gt;</div>\n", 
            "                         </td>\n", 
            "                         <td>Yes</td>\n", 
            "                         <td>N/A</td>\n"
          ]
        }, 
        {
          "locn": "-190,7 +200,7", 
          "lines": [
            "                             Specify the location to which the files should be moved after successfully\n", 
            "                             processing them. Required if transport.vfs.ActionAfterProcess is set to\n", 
            "                             MOVE. Ignored otherwise. Value must be a valid URI (local or remote).\n", 
            "-                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.MoveAfterProcess\"&gt;file:///home/user/test/original&lt;/parameter&gt;</div>\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.MoveAfterProcess\"&gt;file:///home/test/original&lt;/parameter&gt;</div>\n", 
            "                         </td>\n", 
            "                         <td>No</td>\n", 
            "                         <td>N/A</td>\n"
          ]
        }, 
        {
          "locn": "-298,41 +308,36", 
          "lines": [
            "                         <td>false</td>\n", 
            "                     </tr>\n", 
            "                     <tr>\n", 
            "-                        <td>transport.vfs.UseTempFile</td>\n", 
            "-                        <td>If this parameter is set to true, the transport will create a temporary, then\n", 
            "-                        will transfer the content and it will be renamed to the configured file name. This\n", 
            "-                        is specially useful to avoid processing of partially transferred files using VFS\n", 
            "-                        transport. This configuration should be configured as part of the endpoint\n", 
            "-                        deceleration.</td>\n", 
            "-                        <td>No</td>\n", 
            "-                        <td>false</td>\n", 
            "-                    </tr>\n", 
            "-                    <tr>\n", 
            "                         <td>transport.vfs.MaxRetryCount</td>\n", 
            "-                        <td>The number of attempts that the polling task should attempt to poll the remote\n", 
            "-                        VFS destination after an error occurs when trying to resolve the remote file.\n", 
            "-                        For each erroneous attempts polling will be suspended for the amount given by\n", 
            "-                        the parameter 'transport.vfs.ReconnectTimeout'.\n", 
            "-                        <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.MaxRetryCount\"&gt;3&lt;/parameter&gt;</div>\n", 
            "+                        <td>\n", 
            "+                            If the file transport listener encounters an error while trying to\n", 
            "+                            read a file, it will try to read the file again after some time. This\n", 
            "+                            parameter sets the maximum number of times the listener should retry\n", 
            "+                            before giving up. Use the <a href=\"#transport.vfs.ReconnectTimeout\">transport.vfs.ReconnectTimeout</a>\n", 
            "+                            parameter to set the time duration between retries.\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.MaxRetryCount\"&gt;3&lt;/parameter&gt;</div>\n", 
            "                         </td>\n", 
            "                         <td>No</td>\n", 
            "                         <td>3</td>\n", 
            "                     </tr>\n", 
            "                     <tr>\n", 
            "-                        <td>transport.vfs.ReconnectTimeout</td>\n", 
            "-                        <td>The amount the current polling task should be suspended after the failed\n", 
            "-                        attempt to resolve the file object.\n", 
            "-                        <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.ReconnectTimeout\"&gt;30000&lt;/parameter&gt;</div>\n", 
            "+                        <td>transport.vfs.ReconnectTimeout <a name=\"transport.vfs.ReconnectTimeout\"/></td>\n", 
            "+                        <td>\n", 
            "+                            The amount of time (in seconds) the current polling task should be\n", 
            "+                            suspended for after a failed attempt to resolve a file.\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.ReconnectTimeout\"&gt;30000&lt;/parameter&gt;</div>\n", 
            "                         </td>\n", 
            "                         <td>No</td>\n", 
            "-                        <td>30000 milliseconds</td>\n", 
            "+                        <td>30</td>\n", 
            "                     </tr>\n", 
            "                     <tr>\n", 
            "-                        <td>transport.vfs.FailedRecordsFileName</td>\n", 
            "-                        <td>Once the processing is done on a file it will be moved(to a new file) or\n", 
            "-                        deleted. If this operation fails, a log can be written with the cause to the\n", 
            "-                        given fail record file.\n", 
            "-                        <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.FailedRecordsFileName\"&gt;vfs-move-failed-records.properties&lt;/parameter&gt;</div>\n", 
            "+                        <td>transport.vfs.FailedRecordsFileName <a name=\"transport.vfs.FailedRecordsFileName\"/></td>\n", 
            "+                        <td>\n", 
            "+                            Once a file has been fully processed, it will be moved to a new\n", 
            "+                            location or deleted. If this operation fails, a log entry with the\n", 
            "+                            failure details can be written to a separate log file. This parameter\n", 
            "+                            controls the name of this failure log file.\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.FailedRecordsFileName\"&gt;move-errors.txt&lt;/parameter&gt;</div>\n", 
            "                         </td>\n", 
            "                         <td>No</td>\n", 
            "                         <td>vfs-move-failed-records.properties</td>\n"
          ]
        }, 
        {
          "locn": "-339,9 +344,14", 
          "lines": [
            "                     </tr>\n", 
            "                     <tr>\n", 
            "                         <td>transport.vfs.FailedRecordsFileDestination</td>\n", 
            "-                        <td>The destination to create the log file of failed move or delete operations\n", 
            "-                        on processed files.\n", 
            "-                        <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.FailedRecordsFileDestination\"&gt;repository/conf&lt;/parameter&gt;</div>\n", 
            "+                        <td>\n", 
            "+                            Once a file has been fully processed, it will be moved to a new\n", 
            "+                            location or deleted. If this operation fails, a log entry with the\n", 
            "+                            failure details can be written to a separate log file. This parameter\n", 
            "+                            controls the location (directory path) of this failure log file. To set\n", 
            "+                            the name of the log file use the <a href=\"#transport.vfs.FailedRecordsFileName\">transport.vfs.FailedRecordsFileName</a>\n", 
            "+                            parameter.\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.FailedRecordsFileDestination\"&gt;logs/&lt;/parameter&gt;</div>\n", 
            "                         </td>\n", 
            "                         <td>No</td>\n", 
            "                         <td>repository/conf</td>\n"
          ]
        }, 
        {
          "locn": "-348,16 +358,19", 
          "lines": [
            "                     </tr>\n", 
            "                     <tr>\n", 
            "                         <td>transport.vfs.FailedRecordNextRetryDuration</td>\n", 
            "-                        <td>Once a move operation failed, the move task will be retried after this\n", 
            "-                        configured amount of time.\n", 
            "-                        <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.FailedRecordsFileName\"&gt;vfs-move-failed-records.properties&lt;/parameter&gt;</div>\n", 
            "+                        <td>\n", 
            "+                            When a move operation has failed, the operation will be retried after this\n", 
            "+                            amount of time (configured in milliseconds).\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.FailedRecordNextRetryDuration\"&gt;5000&lt;/parameter&gt;</div>\n", 
            "                         </td>\n", 
            "                         <td>No</td>\n", 
            "-                        <td>3000 milliseconds</td>\n", 
            "+                        <td>3000</td>\n", 
            "                     </tr>\n", 
            "                     <tr>\n", 
            "                         <td>transport.vfs.MoveAfterFailedMove</td>\n", 
            "-                        <td>The destination to move the file after a failed move attempt.\n", 
            "+                        <td>\n", 
            "+                            The destination to move the file after a failed move attempt.\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.MoveAfterFailedMove\"&gt;repository/move-errors&lt;/parameter&gt;</div>\n", 
            "                         </td>\n", 
            "                         <td>No</td>\n", 
            "                         <td>N/A</td>\n"
          ]
        }, 
        {
          "locn": "-364,8 +377,10", 
          "lines": [
            "                     </tr>\n", 
            "                     <tr>\n", 
            "                         <td>transport.vfs.MoveFailedRecordTimestampFormat</td>\n", 
            "-                        <td>The time stamp format to report the failed move operation in the log.\n", 
            "-                        <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.MoveFailedRecordTimestampFormat\"&gt;dd/MM/yyyy/ HH:mm:ss&lt;/parameter&gt;</div>\n", 
            "+                        <td>\n", 
            "+                            The time stamp format to use when reporting failed move operations in\n", 
            "+                            the log.\n", 
            "+                            <div class=\"xmlConf\">&lt;parameter name=\"transport.vfs.MoveFailedRecordTimestampFormat\"&gt;HH:mm:ss&lt;/parameter&gt;</div>\n", 
            "                         </td>\n", 
            "                         <td>No</td>\n", 
            "                         <td>dd/MM/yyyy/ HH:mm:ss</td>\n"
          ]
        }, 
        {
          "locn": "-413,6 +428,8", 
          "lines": [
            "                         <tt>ftp://myusername:mypassword@somehost/pub/downloads/somefile.tgz</tt>\n", 
            "                     </li>\n", 
            "                 </ul>\n", 
            "+\n", 
            "+                <h4>File Locking <a name=\"Locking\"/></h4>\n", 
            "                 <p>\n", 
            "                     By default file locking is globally enabled for the file transport sender.\n", 
            "                     This behavior can be overridden at the endpoint level by specifying\n"
          ]
        }, 
        {
          "locn": "-426,6 +443,8", 
          "lines": [
            "                     You may also change the global locking behavior by setting the <tt>transport.vfs.Locking</tt>\n", 
            "                     parameter in the file transport sender configuration in axis2.xml file.\n", 
            "                 </p>\n", 
            "+\n", 
            "+                <h4>FTP Passive Mode <a name=\"Passive\"/></h4>\n", 
            "                 <p>\n", 
            "                     When writing to remote file locations using a protocol such as FTP, you might\n", 
            "                     want Synapse to communicate with the FTP server in the passive mode. To\n"
          ]
        }, 
        {
          "locn": "-435,7 +454,71", 
          "lines": [
            "                 <div class=\"xmlConf\">&lt;endpoint&gt;\n", 
            "     &lt;address uri=&quot;vfs:ftp://myusername:mypassword@somehost/pub/downloads/somefile.tgz?vfs.passive=true&quot;/&gt;\n", 
            " &lt;/endpoint&gt;</div>\n", 
            "+\n", 
            "+                <h4>Retrying on Error <a name=\"Retry\"/></h4>\n", 
            "                 <p>\n", 
            "+                    When the file transport sender encounters an error while trying to write a file,\n", 
            "+                    it can retry after some time. This is useful to recover from certain types of\n", 
            "+                    transient I/O errors and network connectivity issues. Following parameters\n", 
            "+                    can be configured as URL query parameters on the file (vfs) endpoints to\n", 
            "+                    make use of this feature.\n", 
            "+                </p>\n", 
            "+                <table>\n", 
            "+                    <tr>\n", 
            "+                        <th>Parameter Name</th>\n", 
            "+                        <th>Description/Example</th>\n", 
            "+                        <th>Required</th>\n", 
            "+                        <th>Default</th>\n", 
            "+                    </tr>\n", 
            "+                    <tr>\n", 
            "+                        <td>transport.vfs.MaxRetryCount</td>\n", 
            "+                        <td>\n", 
            "+                            Maximum number of retries to perform before giving up.\n", 
            "+                        </td>\n", 
            "+                        <td>No</td>\n", 
            "+                        <td>3</td>\n", 
            "+                    </tr>\n", 
            "+                    <tr>\n", 
            "+                        <td>transport.vfs.ReconnectTimeout</td>\n", 
            "+                        <td>\n", 
            "+                            Time duration (in seconds) between retry attempts.\n", 
            "+                        </td>\n", 
            "+                        <td>No</td>\n", 
            "+                        <td>30</td>\n", 
            "+                    </tr>\n", 
            "+                </table>\n", 
            "+\n", 
            "+                <h4>Using Temporary Files <a name=\"transport.vfs.UseTempFile\"/></h4>\n", 
            "+                <p>\n", 
            "+                    The file transport sender does not write file content atomically. Therefore a\n", 
            "+                    process reading a file updated by Synapse, may read partial\n", 
            "+                    content. To get around this limitation, the temporary file support can be\n", 
            "+                    activated on the target file (vfs) endpoint:\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;endpoint&gt;\n", 
            "+    &lt;address uri=&quot;vfs:file:///var/spool/synapse/out?transport.vfs.UseTempFile=true&quot;/&gt;\n", 
            "+&lt;/endpoint&gt;</div>\n", 
            "+                <p>\n", 
            "+                    This forces the file transport sender to write the data to a temporary file and\n", 
            "+                    then move the temporary file to the actual destination configured in the file\n", 
            "+                    endpoint. On most operating systems (e.g. Unix/Linux, Windows), this delivers the\n", 
            "+                    desired atomic file update behavior. When the file endpoint points to a remote\n", 
            "+                    file system, the temporary files will be created on the remote file system, thus\n", 
            "+                    preserving the atomic update behavior.\n", 
            "+                </p>\n", 
            "+\n", 
            "+                <h4>Appending to Files <a name=\"Append\"/></h4>\n", 
            "+                <p>\n", 
            "+                    When updating an existing file, the file transport sender usually overwrites the\n", 
            "+                    old content. To get append behavior instead, set transport.vfs.Append parameter\n", 
            "+                    on the target endpoint:\n", 
            "+                </p>\n", 
            "+                <div class=\"xmlConf\">&lt;endpoint&gt;\n", 
            "+    &lt;address uri=&quot;vfs:file:///var/spool/synapse/out?transport.vfs.Append=true&quot;/&gt;\n", 
            "+&lt;/endpoint&gt;</div>\n", 
            "+\n", 
            "+                <h4>Out-only Message Exchange Pattern <a name=\"OutOnly\"/></h4>\n", 
            "+                <p>\n", 
            "                     It should be noted that by its nature, the file transport sender doesn't support\n", 
            "                     synchronous responses and should only be invoked using the out-only message\n", 
            "                     exchange pattern. In a Synapse mediation (sequence/proxy/API), this can be forced\n"
          ]
        }, 
        {
          "locn": "-489,6 +572,8", 
          "lines": [
            "             </p>\n", 
            "             <p>\n", 
            "                 It should also be noted that the VFS transport sender doesn't create files atomically.\n", 
            "+                Use the <a href=\"#transport.vfs.UseTempFile\">transport.vfs.UseTempFile</a> endpoint\n", 
            "+                parameter to get around this issue.\n", 
            "             </p>\n", 
            "         </section>\n", 
            "     </body>\n"
          ]
        }
      ], 
      "to": "java/modules/documentation/src/site/xdoc/userguide/transports/vfs.xml", 
      "from": "java/modules/documentation/src/site/xdoc/userguide/transports/vfs.xml"
    }
  ], 
  "id": "1515239"
}